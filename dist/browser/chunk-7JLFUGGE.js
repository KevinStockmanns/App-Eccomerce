import{b as A}from"./chunk-AC3WT4O5.js";import{a as R}from"./chunk-MD5CZJF7.js";import{a as V}from"./chunk-DGK2EHOG.js";import{a as T}from"./chunk-RR3A66G7.js";import{a as k}from"./chunk-NMAY4UGY.js";import{b as y,c as w,d as j}from"./chunk-BC2EWL22.js";import{$a as E,Bb as I,Cb as b,Db as v,Ja as l,Ka as h,Xa as g,Z as P,bb as m,db as O,eb as S,fb as a,ga as p,gb as i,ha as u,hb as _,ib as C,mb as f,nb as s,vb as r,xb as x}from"./chunk-LPK2HR6M.js";var F=(o,c)=>c.id;function M(o,c){o&1&&(a(0,"span",8),r(1,"Se aplicar\xE1 el precio actual."),i())}function J(o,c){o&1&&(a(0,"span",8),r(1,"Se aplicar\xE1 el precio de reventa."),i())}function N(o,c){if(o&1){let n=C();a(0,"button",12),f("click",function(){p(n);let t=s().$implicit,d=s();return u(d.applyNewPrecio(t.id))}),r(1,"APLICAR PRECIO NUEVO"),i()}}function L(o,c){if(o&1){let n=C();a(0,"button",12),f("click",function(){p(n);let t=s().$implicit,d=s();return u(d.applyPrecioReventa(t.id))}),r(1,"APLICAR PRECIO REVENTA"),i()}}function D(o,c){if(o&1){let n=C();a(0,"button",13),f("click",function(){p(n);let t=s().$implicit,d=s();return u(d.eliminarCambios(t.id))}),r(1,"REESTABLECER"),i()}}function z(o,c){if(o&1&&(a(0,"div",7)(1,"p")(2,"b"),r(3,"Producto: "),i(),r(4),b(5,"titlecase"),g(6,M,2,0,"span",8)(7,J,2,0,"span",8),i(),a(8,"p")(9,"b"),r(10,"Cantidad:"),i(),r(11),i(),a(12,"p")(13,"b"),r(14,"Precio Unitario:"),i(),r(15),b(16,"currency"),i(),a(17,"div",9),g(18,N,2,0,"button",10)(19,L,2,0,"button",10)(20,D,2,0,"button",11),i()(),_(21,"div",5)),o&2){let n=c.$implicit,e=s();E("cambio",e.ordenInJson(n.id)),l(4),x("",v(5,10,n.producto.nombreProducto+" "+n.producto.nombreVersion)," "),l(2),m(6,e.ordenInJson(n.id)&&e.ordenInJson(n.id).aplicarPrecioActual?6:-1),l(),m(7,e.ordenInJson(n.id)&&e.ordenInJson(n.id).aplicarDescuento?7:-1),l(4),x(" ",n.cantidad,""),l(4),x(" ",v(16,12,n.precioUnitario)," ARS"),l(3),m(18,!e.ordenInJson(n.id)||!e.ordenInJson(n.id).aplicarPrecioActual?18:-1),l(),m(19,!e.ordenInJson(n.id)||!e.ordenInJson(n.id).aplicarDescuento?19:-1),l(),m(20,e.ordenInJson(n.id)?20:-1)}}function $(o,c){if(o&1){let n=C();a(0,"button",14),f("click",function(){p(n);let t=s();return u(t.cancelar())}),r(1,"CANCELAR"),i(),a(2,"button",12),f("click",function(){p(n);let t=s();return u(t.onConfirm())}),r(3,"CONFIRMAR"),i()}}function H(o,c){o&1&&_(0,"app-loader")}var Y=(()=>{let c=class c{constructor(e,t,d){this.cartService=e,this.location=t,this.notification=d,this.loadingResponse=!1,this.jsonOrdenes=[],this.pedido=e.pedidoSelected}cancelar(){this.location.back(),this.cartService.setPedidoSelected(null)}applyNewPrecio(e){let t={idOrden:e,aplicarPrecioActual:!0};this.jsonOrdenes=this.jsonOrdenes.filter(d=>d.idOrden!==e),this.jsonOrdenes.push(t)}applyPrecioReventa(e){let t={idOrden:e,aplicarDescuento:!0};this.jsonOrdenes=this.jsonOrdenes.filter(d=>d.idOrden!==e),this.jsonOrdenes.push(t)}eliminarCambios(e){this.jsonOrdenes=this.jsonOrdenes.filter(t=>t.idOrden!=e)}ordenInJson(e){return this.jsonOrdenes.find(t=>t.idOrden==e)}onConfirm(){this.loadingResponse=!0,this.cartService.confirmarPedido(this.pedido.id,this.jsonOrdenes.length===0?{}:{ordenes:this.jsonOrdenes}).subscribe({next:e=>{A(e.body,"pedido"),this.location.back(),this.loadingResponse=!1,this.notification.notificate("El pedido fue actualizado con \xE9xito",{error:!1})},error:e=>{this.loadingResponse=!1,this.notification.notificate(e.error.errors[0].error||"No se pudo confirmar el pedido. Intentalo m\xE1s tarde",{error:!0})}})}};c.\u0275fac=function(t){return new(t||c)(h(k),h(y),h(T))},c.\u0275cmp=P({type:c,selectors:[["app-confirm-page"]],standalone:!0,features:[I],decls:24,vars:2,consts:[[1,"main","content"],[1,"confirm-content"],[1,"title"],[1,"confirm-header"],[1,"confirm-body"],[1,"line-separator"],[1,"confirm-footer"],[1,"orden"],[1,"span-cambio"],[1,"actions"],[1,"btn","btn-simple","cursor"],[1,"btn","btn-simple","neutro","cursor"],[1,"btn","btn-simple","cursor",3,"click"],[1,"btn","btn-simple","neutro","cursor",3,"click"],[1,"btn","btn-simple","red","cursor",3,"click"]],template:function(t,d){t&1&&(_(0,"app-header"),a(1,"main",0)(2,"section",1)(3,"h1",2),r(4,"Confirmar Pedido"),i(),a(5,"div",3)(6,"p"),r(7),i(),a(8,"ul")(9,"li"),r(10,"Confirmar el pedido sin cambiar los precios."),i(),a(11,"li"),r(12,"Confirmar el pedido cambiando a un precio actual (en caso de que la orden se haya realizado hace tiempo)."),i(),a(13,"li"),r(14,"Confirmar el pedido aplicando precio de reventa si lo desea (el precio actual)."),i()()(),a(15,"div",4)(16,"h2"),r(17,"Ordenes"),i(),_(18,"div",5),O(19,z,22,14,null,null,F),i(),a(21,"div",6),g(22,$,4,0)(23,H,1,0),i()()()),t&2&&(l(7),x("El pedido con id ",d.pedido.id," ser\xE1 confirmado con las siguientes ordenes. Aqu\xED puede revisar el precio que tiene las ordenes y puedes realizar las siguientes acciones"),l(12),S(d.pedido.ordenes),l(3),m(22,d.loadingResponse?23:22))},dependencies:[R,w,j,V],styles:["main[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%;height:calc(100vh - var(--headerHeight))}.confirm-content[_ngcontent-%COMP%]{display:grid;padding:1rem;width:100%;max-width:600px;border-radius:var(--borderrHigh);max-height:calc(100vh - var(--headerHeight) - 2rem);background-color:var(--bgCardColor);overflow:auto}h1[_ngcontent-%COMP%]{text-align:center;justify-self:center}.orden[_ngcontent-%COMP%]{transition:var(--transitionFast);padding:.5rem 0rem}.orden.cambio[_ngcontent-%COMP%]{background-color:var(--mainLowAlphaColor);padding:.5rem;border-radius:var(--borderrMid)}.span-cambio[_ngcontent-%COMP%]{font-size:80%;color:var(--mainColor)}.actions[_ngcontent-%COMP%]{display:grid;justify-items:center;margin-top:.5rem;font-size:.8rem}.confirm-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}@media screen and (min-width:500px){.actions[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}}"]});let o=c;return o})();export{Y as ConfirmPageComponent};
