<back-btn></back-btn>
<main class="main content">
    <section class="signup-content box-shadow" style="view-transition-name: login-signup-view;">
        <h1>¡Registrate Ahora!</h1>
        <form (submit)="onSubmit()" [formGroup]="signupForm">
            <div class="form-div">
                <div class="form-div-input" [class.withText]="hasValue('nombre')"  [class.error]="hasOneError('nombre')">
                    <input type="text" id="nombre" formControlName="nombre">
                    <label for="nombre">Nombre</label>
                </div>
                @if (hasError('nombre', 'required')) {
                    <p class="form-div-error">El nombre es requerido</p>
                }
                @if (hasError('nombre', 'pattern')) {
                    <p class="form-div-error">El nombre solo acepta letras y espacios en blanco</p>
                }
                @if (hasError('nombre', 'maxlength')) {
                    <p class="form-div-error">El nombre acepta hasta {{ getError('nombre', 'maxlength')?.requiredLength ?? 0 }} caracteres</p>
                }
                @if (hasError('nombre', 'minlength')) {
                    <p class="form-div-error">El nombre requiere al menos {{ getError('nombre', 'minlength')?.requiredLength }} caracteres</p>
                }
            </div>

            <div class="form-div">
                <div class="form-div-input" [class.withText]="hasValue('apellido')" [class.error]="hasOneError('apellido')">
                    <input type="text" id="apellido" formControlName="apellido">
                    <label for="apellido">Apellido</label>
                </div>
                @if (hasError('apellido', 'required')) {
                    <p class="form-div-error">El apellido es requerido</p>
                }
                @if (hasError('apellido', 'pattern')) {
                    <p class="form-div-error">El apellido solo acepta letras y espacios en blanco</p>
                }
                @if (hasError('apellido', 'maxlength')) {
                    <p class="form-div-error">El apellido acepta hasta {{getError('apellido', 'maxlength').requiredLength}} caracteres</p>
                }
                @if (hasError('apellido', 'minlength')) {
                    <p class="form-div-error">El apellido requiere {{getError('apellido', 'minlength').requiredLength}} caracteres</p>
                }
            </div>

            <div class="form-div col-2">
                <div class="form-div-input" [class.withText]="hasValue('correo')" [class.error]="hasOneError('correo')">
                    <input type="email" id="correo" formControlName="correo">
                    <label for="correo">Correo</label>
                </div>
                @if(hasError('correo', 'required')){
                    <p class="form-div-error">El correo es requerido</p>
                }
                @if(hasError('correo', 'email')){
                    <p class="form-div-error">El formato del correo es inválido</p>
                }
            </div>

            <div class="form-div col-2">
                <div class="form-div-input" [class.withText]="hasValue('telefono')" [class.error]="hasOneError('telefono')">
                    <input type="tel" id="telefono" formControlName="telefono">
                    <label for="telefono">Telefono</label>
                </div>
                @if(hasError('telefono', 'required')){
                    <p class="form-div-error">El telefono es requerido</p>
                }
                @if(hasError('telefono', 'pattern')){
                    <p class="form-div-error">El formato del telefono es +00 0000 000000</p>
                }
            </div>

            <div class="form-div">
                <div class="form-div-input" [class.withText]="hasValue('clave')" [class.error]="hasOneError('clave')">
                    <input type="password" id="clave" autocomplete="off" formControlName="clave">
                    <label for="clave">Clave</label>
                </div>

                @if(hasError('clave', 'required')){
                    <p class="form-div-error">La clave es requerida</p>
                }
                @if(hasError('clave', 'pattern')){
                    <p class="form-div-error">La clave acepta letras, numeros y caracteres especiales(_  -)</p>
                }
                @if(hasError('clave', 'maxlength')){
                    <p class="form-div-error">La clave debe tener hasta {{getError('clave', 'maxlength').requiredLength}} caracteres</p>
                }
                @if(hasError('clave', 'minlength')){
                    <p class="form-div-error">La clave debe tener al menos {{getError('clave', 'minlength').requiredLength}} caracteres</p>
                }
            </div>

            <div class="form-div">
                <div class="form-div-input" [class.withText]="hasValue('clave2')" [class.error]="hasOneError('clave2')">
                    <input type="password" id="clave2" autocomplete="off" formControlName="clave2">
                    <label for="clave2">Repetir clave</label>
                </div>
                @if(hasError('clave2', 'required')){
                    <p class="form-div-error">La clave es requerida</p>
                }
                @if(hasError('clave2', 'pattern')){
                    <p class="form-div-error">La clave acepta letras, numeros y caracteres especiales(_  -)</p>
                }
                @if(hasError('clave2', 'maxlength')){
                    <p class="form-div-error">La clave debe tener hasta {{getError('clave2', 'maxlength').requiredLength}} caracteres</p>
                }
                @if(hasError('clave2', 'minlength')){
                    <p class="form-div-error">La clave debe tener al menos {{getError('clave2', 'minlength').requiredLength}} caracteres</p>
                }
                @if(hasError('clave2', 'repeatClave')){
                    <p class="form-div-error">Las claves deben ser iguales</p>
                }
            </div>

            <div class="form-div">
                <div class="form-div-input withValue" [class.withText]="hasValue('fechaNacimiento')" [class.error]="hasOneError('fechaNacimiento')">
                    <input type="date" id="fechaNacimiento" formControlName="fechaNacimiento">
                    <label for="fechaNacimiento">Fecha de nacimiento</label>
                </div>
                @if (hasError('fechaNacimiento', 'required')) {
                    <p class="form-div-error">La fecha de nacimiento es requerida</p>
                }
                @if (hasError('fechaNacimiento', 'underage')) {
                    <p class="form-div-error">Debes tener {{getError('fechaNacimiento', 'underage').requiredAge}} años o más</p>
                }
            </div>
            <div class="form-div">
                <div class="form-div-input" [class.withText]="hasValue('pais')" [class.error]="hasOneError('pais')">
                    <input type="text" id="pais" formControlName="pais" title="Por el momento solo se realizan pedidos en Argentina.">
                    <label for="pais">País</label>
                </div>
                @if(hasError('pais', 'required')){
                    <p class="form-div-error">El país es requerido.</p>
                }
            </div>
            <div class="form-div">
                <div class="form-div-input" [class.withText]="hasValue('provincia')" [class.error]="hasOneError('provincia')">
                    @if(provincias.length>0){
                        <select formControlName="provincia" id="provincia">
                            @for (prov of provincias; track prov.id) {
                                <option [value]="prov.nombre">{{prov.nombre}}</option>
                            }
                        </select>
                    }@else {
                        <input type="text" id="provincia" formControlName="provincia">
                    }
                    <label for="provincia">Provincia</label>
                </div>
                @if(hasError('provincia', 'required')){
                    <p class="form-div-error">La provincia es requerida.</p>
                }
            </div>
            @if(localidades.length>0 || wasTouched('provincia')){
                <div class="form-div">
                    <div class="form-div-input" [class.withText]="hasValue('localidad')" [class.error]="hasOneError('localidad')">
                        @if(localidades.length>0){
                            <select formControlName="localidad" id="localidad">
                                @for (localidad of localidades; track localidad.id) {
                                    <option [value]="localidad.nombre">{{localidad.nombre}}</option>
                                }
                            </select>
                        }@else {
                            <input type="text" id="localidad" formControlName="localidad">
                        }
                        <label for="localidad">Localidad</label>
                    </div>
                    @if(hasError('localidad', 'required')){
                        <p class="form-div-error">La localidad es requerida.</p>
                    }
                </div>

                <div class="form-div">
                    <div class="form-div-input" [class.withText]="hasValue('barrio')" [class.error]="hasOneError('barrio')">
                        <input type="text" id="barrio" formControlName="barrio">
                        <label for="barrio">Barrio</label>
                    </div>
                    @if(hasError('barrio', 'required')){
                        <p class="form-div-error">El barrio es requerido.</p>
                    }
                </div>

                <div class="form-div">
                    <div class="form-div-input" [class.withText]="hasValue('direccion')" [class.error]="hasOneError('direccion')">
                        <input type="text" id="direccion" formControlName="direccion">
                        <label for="direccion">Dirección</label>
                    </div>
                    @if(hasError('direccion', 'required')){
                        <p class="form-div-error">La dirección es requerida.</p>
                    }
                </div>
            }


            <div class="form-submit col-2">
                <button type="submit" class="btn btn-primary">
                    @if(!loading){
                        <span>Registrarme</span>
                    }@else {
                        <div class="loader"></div>
                    }
                </button>
                @for (item of error; track $index) {
                    <p class="form-div-error" style="text-align: center;">{{item.error}}</p>
                }
            </div>
        </form>
    </section>
    <section class="beneficios-usuarios-content box-shadow">
        <usuario-beneficios></usuario-beneficios>
    </section>
</main>
